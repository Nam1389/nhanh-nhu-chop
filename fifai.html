<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Nhanh Nh∆∞ Ch·ªõp ‚Äî 3 Team</title>
<style>
  :root{
    --bg:#ffffff;
    --text:#111;
    --accentA:#ff595e; /* Team A */
    --accentB:#1982c4; /* Team B */
    --accentC:#6ab04c; /* Team C */
    --card-shadow: 0 6px 24px rgba(0,0,0,0.08);
    --max-steps:10;
  }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; font-family: "Segoe UI", Roboto, Arial, sans-serif; background:var(--bg); color:var(--text);}
  .wrap{
    min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:18px;
    padding:28px;
  }

  /* Timer top-right */
  #timer{
    position:fixed; top:18px; right:26px; font-weight:700; font-size:28px;
    background:rgba(0,0,0,0.04); padding:8px 14px; border-radius:10px; box-shadow:var(--card-shadow);
  }

  /* Big question card (slide style) */
  .question-card{
    width:min(980px, 96vw);
    height:280px;
    border-radius:14px;
    display:flex; align-items:center; justify-content:center; flex-direction:column;
    background:linear-gradient(180deg, rgba(255,255,255,1), rgba(250,250,250,1));
    box-shadow:var(--card-shadow);
    text-align:center;
    padding:20px;
    position:relative;
    overflow:hidden;
  }
  .q-number{ position:absolute; left:16px; top:12px; font-size:14px; color:#666; }
  #question{
    font-size:44px; font-weight:800; line-height:1.05; letter-spacing:0.6px;
    opacity:0; transform:scale(0.98); transition:all 420ms cubic-bezier(.2,.9,.2,1);
  }
  #question.show{ opacity:1; transform:scale(1); }

  /* Controls */
  .controls{ display:flex; gap:12px; margin-top:6px; }
  button{
    padding:10px 16px; font-size:16px; font-weight:700; border-radius:10px; border:0; cursor:pointer;
    box-shadow: 0 6px 18px rgba(0,0,0,0.06);
  }
  button:active{ transform:translateY(1px); }
  .btn-start{ background: linear-gradient(90deg,#ff7b7b,#ff595e); color:white; }
  .btn-correct{ background: linear-gradient(90deg,#8ef88e, #6ab04c); color:#04320a; }
  .btn-wrong{ background: linear-gradient(90deg,#ffd6d6,#ff9b9b); color:#600; }
  .btn-next{ background:#f0f0f0; color:#222; }

  /* Teams area */
  .teams{
    display:flex; gap:14px; width:min(980px,96vw); justify-content:space-between;
  }
  .team{
    flex:1; background:linear-gradient(180deg, #fff, #fbfbfb); border-radius:12px; padding:12px;
    box-shadow: var(--card-shadow); display:flex; flex-direction:column; align-items:center; gap:14px;
    cursor:pointer; user-select:none;
    transition:transform 200ms, box-shadow 200ms, border 200ms;
  }
  .team.active{ transform:translateY(-6px); box-shadow: 0 12px 30px rgba(0,0,0,0.12); }
  .team-header{ font-weight:800; font-size:18px; display:flex; gap:8px; align-items:center; }
  .team-dot{ width:14px; height:14px; border-radius:50%; display:inline-block; }
  .team-score{ font-size:28px; font-weight:900; margin-top:4px; }

  /* Steps column */
  .steps{ display:flex; flex-direction:column-reverse; gap:8px; align-items:center; justify-content:center; padding:6px;}
  .step{
    width:54px; height:28px; border-radius:8px; background: #eee; display:flex; align-items:center; justify-content:center;
    font-weight:700; color:#444; box-shadow: inset 0 -2px 0 rgba(0,0,0,0.03);
  }
  .step.filledA{ background: linear-gradient(90deg,var(--accentA), #ff8b8b); color:white; }
  .step.filledB{ background: linear-gradient(90deg,var(--accentB), #3aa0ff); color:white; }
  .step.filledC{ background: linear-gradient(90deg,var(--accentC), #9adf6b); color:white; }

  /* small helper text */
  .hint{ font-size:13px; color:#666; margin-top:6px; }

  /* Winner overlay */
  .overlay{
    position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.45);
  }
  .overlay.show{ display:flex; }
  .winner-card{ background:white; padding:28px 34px; border-radius:14px; text-align:center; box-shadow: 0 30px 60px rgba(0,0,0,0.35); }
  .winner-card h2{ margin:0 0 8px 0; font-size:32px; }
  .winner-card p{ margin:0 0 12px 0; font-size:18px; color:#333; }

  /* Responsive */
  @media (max-width:880px){
    #question{ font-size:28px; }
    .team{ padding:10px; }
    .step{ width:44px; height:24px; font-size:13px; }
    .teams{ flex-direction:column; gap:10px; width:92vw; }
  }
</style>
</head>
<body>
  <div id="timer">2:00</div>

  <div class="wrap">
    <div class="question-card" role="region" aria-label="C√¢u h·ªèi">
      <div class="q-number" id="qNumber">‚Äî</div>
      <div id="question">B·∫ÆT ƒê·∫¶U</div>
      <div class="controls">
        <button id="startBtn" class="btn-start">B·∫Øt ƒë·∫ßu</button>
        <button id="correctBtn" class="btn-correct" style="display:none">ƒê√∫ng</button>
        <button id="wrongBtn" class="btn-wrong" style="display:none">Sai</button>
        <button id="nextBtn" class="btn-next" style="display:none">Ti·∫øp</button>
        <button id="resetBtn" class="btn-next" style="display:none">Reset</button>
      </div>
      <div class="hint">Click v√†o c·ªôt ƒë·ªôi ƒë·ªÉ ch·ªçn ƒë·ªôi tr·∫£ l·ªùi (ho·∫∑c ƒë·ªÉ l∆∞·ª£t t·ª± lu√¢n phi√™n).</div>
    </div>

    <div class="teams" aria-hidden="false">
      <div class="team" data-index="0" id="team0" title="Team A">
        <div class="team-header"><span class="team-dot" style="background:var(--accentA)"></span> <span>Team A</span></div>
        <div class="team-score" id="score0">0</div>
        <div class="steps" id="steps0"></div>
      </div>

      <div class="team" data-index="1" id="team1" title="Team B">
        <div class="team-header"><span class="team-dot" style="background:var(--accentB)"></span> <span>Team B</span></div>
        <div class="team-score" id="score1">0</div>
        <div class="steps" id="steps1"></div>
      </div>

      <div class="team" data-index="2" id="team2" title="Team C">
        <div class="team-header"><span class="team-dot" style="background:var(--accentC)"></span> <span>Team C</span></div>
        <div class="team-score" id="score2">0</div>
        <div class="steps" id="steps2"></div>
      </div>
    </div>
  </div>

  <!-- Winner overlay -->
  <div class="overlay" id="overlay">
    <div class="winner-card" id="winnerCard">
      <h2 id="winnerTitle">üéâ CH√öC M·ª™NG üéâ</h2>
      <p id="winnerText">Team X chi·∫øn th·∫Øng!</p>
      <div style="margin-top:14px">
        <button id="closeWinner" class="btn-next">ƒê√≥ng</button>
      </div>
    </div>
  </div>

<script>
/* ====== D·ªÆ LI·ªÜU C√ÇU H·ªéI (d√πng n·ªôi dung file .pptx b·∫°n g·ª≠i) ====== */
const questions = [
  "C√¢u h·ªèi s·ªë 1","C√¢u h·ªèi s·ªë 2","C√¢u h·ªèi s·ªë 3","C√¢u h·ªèi s·ªë 4","C√¢u h·ªèi s·ªë 5",
  "C√¢u h·ªèi s·ªë 6","C√¢u h·ªèi s·ªë 7","C√¢u h·ªèi s·ªë 8","C√¢u h·ªèi s·ªë 9","C√¢u h·ªèi s·ªë 10",
  "C√¢u h·ªèi s·ªë 11","C√¢u h·ªèi s·ªë 12","C√¢u h·ªèi s·ªë 13","C√¢u h·ªèi s·ªë 14","C√¢u h·ªèi s·ªë 15",
  "C√¢u h·ªèi s·ªë 16","C√¢u h·ªèi s·ªë 17","C√¢u h·ªèi s·ªë 18","C√¢u h·ªèi s·ªë 19","C√¢u h·ªèi s·ªë 20"
];

/* ====== TR·∫†NG TH√ÅI GAME ====== */
const MAX_STEP = 10;
let state = {
  currentQ: -1,           // index c√¢u h·ªèi ƒëang hi·ªán
  activeTeam: 0,         // 0,1,2
  teams: [
    {name:"Team A", score:0},
    {name:"Team B", score:0},
    {name:"Team C", score:0}
  ],
  timeLeft: 120,         // gi√¢y
  timerId: null,
  autoTurn: true         // lu√¢n phi√™n theo th·ª© t·ª±; nh∆∞ng host c√≥ th·ªÉ click ch·ªçn ƒë·ªôi
};

/* ====== ELEMENTS ====== */
const qEl = document.getElementById('question');
const qNumEl = document.getElementById('qNumber');
const timerEl = document.getElementById('timer');
const startBtn = document.getElementById('startBtn');
const correctBtn = document.getElementById('correctBtn');
const wrongBtn = document.getElementById('wrongBtn');
const nextBtn = document.getElementById('nextBtn');
const resetBtn = document.getElementById('resetBtn');
const overlay = document.getElementById('overlay');
const winnerTitle = document.getElementById('winnerTitle');
const winnerText = document.getElementById('winnerText');
const closeWinner = document.getElementById('closeWinner');

/* Steps DOM creation */
for(let t=0;t<3;t++){
  const stepsWrap = document.getElementById('steps'+t);
  for(let s=MAX_STEP; s>0; s--){
    const div = document.createElement('div');
    div.className = 'step';
    div.textContent = s;
    stepsWrap.appendChild(div);
  }
}

/* render team scores / steps */
function renderTeams(){
  for(let t=0;t<3;t++){
    document.getElementById('score'+t).textContent = state.teams[t].score;
    const stepsWrap = document.getElementById('steps'+t);
    const steps = Array.from(stepsWrap.children);
    steps.forEach((el, idx) => {
      // idx 0 is top (which shows number MAX_STEP), but we want filled for score > idx
      const stepNumber = MAX_STEP - idx;
      el.classList.remove('filledA','filledB','filledC');
      if(stepNumber <= state.teams[t].score){
        if(t===0) el.classList.add('filledA');
        if(t===1) el.classList.add('filledB');
        if(t===2) el.classList.add('filledC');
      }
    });
  }
  highlightActive();
}

/* highlight active team */
function highlightActive(){
  for(let t=0;t<3;t++){
    const el = document.getElementById('team'+t);
    if(t === state.activeTeam) el.classList.add('active'); else el.classList.remove('active');
  }
}

/* set active team (host can click columns) */
document.querySelectorAll('.team').forEach(el=>{
  el.addEventListener('click', ()=> {
    const idx = Number(el.dataset.index);
    state.activeTeam = idx;
    state.autoTurn = false; // host manually selected => stop auto rotation until next correct/wrong
    highlightActive();
  });
});

/* ===== timer ===== */
function formatTime(sec){
  const m = Math.floor(sec/60); const s = sec%60;
  return `${m}:${String(s).padStart(2,'0')}`;
}
function startTimer(){
  timerEl.textContent = formatTime(state.timeLeft);
  state.timerId = setInterval(()=>{
    state.timeLeft--;
    timerEl.textContent = formatTime(Math.max(0, state.timeLeft));
    if(state.timeLeft <= 0){
      clearInterval(state.timerId);
      endGame('time');
    }
  },1000);
}

/* ===== question control ===== */
function showQuestion(index){
  if(index < 0 || index >= questions.length){
    qNumEl.textContent = "‚Äî";
    qEl.textContent = "CH∆ØA C√ì C√ÇU H·ªéI";
    qEl.classList.add('show');
    return;
  }
  qNumEl.textContent = `C√¢u ${index+1} / ${questions.length}`;
  qEl.classList.remove('show');
  setTimeout(()=>{
    qEl.textContent = questions[index];
    qEl.classList.add('show');
  }, 160);
}

/* next question (host button) */
function nextQuestion(){
  state.currentQ++;
  if(state.currentQ >= questions.length){
    endGame('questions');
    return;
  }
  showQuestion(state.currentQ);
  // show control btns
  correctBtn.style.display = 'inline-block';
  wrongBtn.style.display = 'inline-block';
  nextBtn.style.display = 'inline-block';
  resetBtn.style.display = 'inline-block';
}

/* start game */
startBtn.addEventListener('click', ()=>{
  startBtn.style.display = 'none';
  correctBtn.style.display = 'inline-block';
  wrongBtn.style.display = 'inline-block';
  nextBtn.style.display = 'inline-block';
  resetBtn.style.display = 'inline-block';
  state.currentQ = 0;
  showQuestion(state.currentQ);
  highlightActive();
  startTimer();
});

/* correct action */
correctBtn.addEventListener('click', ()=>{
  if(state.currentQ < 0 || state.currentQ >= questions.length) return;
  const team = state.teams[state.activeTeam];
  if(team.score < MAX_STEP){
    team.score += 1;
    // n·∫øu ƒë·∫°t MAX_STEP -> th·∫Øng ngay
    renderTeams();
    animateFlash(state.activeTeam);
    if(team.score >= MAX_STEP){
      endGame('win', state.activeTeam);
      return;
    }
  }
  // t·ª± ƒë·ªông chuy·ªÉn c√¢u h·ªèi v√† chuy·ªÉn l∆∞·ª£t
  state.currentQ++;
  if(state.currentQ >= questions.length){
    endGame('questions'); return;
  }
  showQuestion(state.currentQ);

  // chuy·ªÉn l∆∞·ª£t theo lu√¢n phi√™n ch·ªâ khi autoTurn true; n·∫øu host ƒë√£ click ch·ªçn ƒë·ªôi th√¨ kh√¥ng auto chuy·ªÉn (v·∫´n chuy·ªÉn c√¢u h·ªèi)
  if(state.autoTurn){
    state.activeTeam = (state.activeTeam + 1) % 3;
  } else {
    // n·∫øu host ƒë√£ ch·ªçn th·ªß c√¥ng trong l·∫ßn n√†y, sau khi ghi nh·∫≠n ta reset autoTurn l·∫°i true ƒë·ªÉ sau l·∫ßn ti·∫øp theo v·∫´n lu√¢n phi√™n
    state.autoTurn = true;
  }
  renderTeams();
});

/* wrong action: ƒëi·ªÉm t·ª´ 1..10 s·∫Ω tr·ªü v·ªÅ 0 theo y√™u c·∫ßu */
wrongBtn.addEventListener('click', ()=>{
  if(state.currentQ < 0 || state.currentQ >= questions.length) return;
  // reset ƒë·ªôi hi·ªán t·∫°i v·ªÅ 0
  state.teams[state.activeTeam].score = 0;
  animateWrong(state.activeTeam);
  // chuy·ªÉn l∆∞·ª£t
  state.activeTeam = (state.activeTeam + 1) % 3;
  state.currentQ++;
  if(state.currentQ >= questions.length){
    renderTeams(); showQuestion(state.currentQ-1); endGame('questions'); return;
  }
  showQuestion(state.currentQ);
  renderTeams();
});

/* next question without scoring */
nextBtn.addEventListener('click', ()=>{
  state.currentQ++;
  if(state.currentQ >= questions.length){
    endGame('questions'); return;
  }
  showQuestion(state.currentQ);
});

/* reset (host) */
resetBtn.addEventListener('click', ()=>{
  if(confirm("B·∫°n c√≥ mu·ªën reset to√†n b·ªô ƒëi·ªÉm v√† c√¢u h·ªèi v·ªÅ ƒë·∫ßu kh√¥ng?")){
    window.location.reload();
  }
});

/* animate helpers */
function animateFlash(teamIdx){
  const el = document.getElementById('team'+teamIdx);
  el.animate([{transform:'scale(1.03)'},{transform:'scale(1)'}], {duration:260});
}
function animateWrong(teamIdx){
  const el = document.getElementById('team'+teamIdx);
  el.animate([{transform:'translateX(0)'},{transform:'translateX(-8px)'},{transform:'translateX(8px)'},{transform:'translateX(0)'}], {duration:420});
}

/* end game & show winner */
function endGame(reason, winnerIdx){
  // stop timer
  if(state.timerId) { clearInterval(state.timerId); state.timerId = null; }

  // determine winner(s) highest score
  const max = Math.max(...state.teams.map(t=>t.score));
  const winners = state.teams.map((t,i)=> ({score:t.score,i})).filter(x=>x.score===max);
  let title = "K·∫æT TH√öC";
  let text = "";
  if(winnerIdx !== undefined){
    title = "üéâ CHI·∫æN TH·∫ÆNG üéâ";
    text = `${state.teams[winnerIdx].name} th·∫Øng v·ªõi ${state.teams[winnerIdx].score} n·∫•c!`;
  } else {
    if(max === 0){
      title = "H·∫æT GI·ªú";
      text = "Kh√¥ng ƒë·ªôi n√†o ghi ƒë∆∞·ª£c n·∫•c n√†o.";
    } else if(winners.length === 1){
      title = "üéâ CH√öC M·ª™NG üéâ";
      text = `${state.teams[winners[0].i].name} th·∫Øng v·ªõi ${max} n·∫•c!`;
    } else {
      title = "H√íA";
      text = `H√≤a gi·ªØa: ${winners.map(w=>state.teams[w.i].name).join(' , ')} (m·ªói ƒë·ªôi ${max} n·∫•c)`;
    }
  }
  winnerTitle.textContent = title;
  winnerText.textContent = text;
  overlay.classList.add('show');
}

/* close overlay */
closeWinner.addEventListener('click', ()=>{
  overlay.classList.remove('show');
});

/* initial render */
renderTeams();
qEl.classList.add('show');
qNumEl.textContent = "B·∫ÆT ƒê·∫¶U";

/* Keyboard shortcuts (ph·ª•c v·ª• host): 
   C => Correct, X => Wrong, N => Next, Space => Start
*/
document.addEventListener('keydown', (e)=>{
  const key = e.key.toLowerCase();
  if(key === 'c') correctBtn.click();
  if(key === 'x') wrongBtn.click();
  if(key === 'n') nextBtn.click();
  if(key === ' ' || key === 'spacebar') {
    if(startBtn.style.display !== 'none') startBtn.click();
    e.preventDefault();
  }
});
</script>
</body>
</html>
